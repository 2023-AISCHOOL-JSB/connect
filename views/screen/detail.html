{% extends 'layout.html'%}
{% block content %}
{% include 'components/nav.html' %}
{% include 'components/header.html' %}



<main class="detail">
    <section class="detail__box">
        {%for i in data%}
        <h1 class="detail__title">{{i.b_title}}</h1>
        <div class="detail__info">
            <span class="post-date" data-date="{{ i.created_at }}">-</span>
            <span>최최진진우우</span>
        </div>
        <div class="detail__ud">
            <span>수정</span>
            <span>삭제</span>
        </div>
        <table class="detail__table">
            {%if i.b_type == '모집'%}
            <tr>
                <td class="detail__table--title">모집구분</td>
                <td class="detail__table--desc" data-array="{{ i.b_category }}" data-index="0">-</td>
            </tr>
            <tr>
                <td class="detail__table--title">마감일</td>
                <td class="detail__table--desc"data-array="{{ i.b_category }}" data-index="2">-</td>
            </tr>
            <tr>
                <td class="detail__table--title">모집인원</td>
                <td class="detail__table--desc" data-array="{{ i.b_category }}" data-index="1" data-prepend="명">-</td>
            </tr>
            <tr>
                <td class="detail__table--title">기술스택</td>
                <!-- data-index = 배열의 3번째다 -->
                <td class="detail__table--desc" data-array="{{ i.b_category }}" data-index="3"></td> 
            </tr>
            {%else %}
            {%endif%}
        </table>
        <section class="detail__desc">
            {{i.b_content}}
        </section>
        <div class="detail__buttons">
            <a href="/chat">Chat</a>
            <a href="/">github</a>
            <button type="button"><i class="fa-regular fa-heart"></i> <span class="detail__like"> 5</span></button>
        </div>

        <form class="detail__msg">
            <h1 class="detail__msg--title">댓글<span class="detail__msg--num">0</span></h1>
            <div>
                <input class="detail__msg--input" type="text" name="coment">
                <button class="detail__msg--btn" type="submit">댓글 작성</button>
            </div>
        </form>
        <ul class="detail__msg-list">
            <li>
                <h1>김영재</h1>
                <span>2023.07.23 17:00</span>
                <p>치연쓰 채팅 기능 구현 해쓰~</p>
            </li>
        </ul>
    </section>
    {%endfor%}
</main>

<script>
    
function populateElement(element) {
    // data-array, data-index 및 data-prepend 속성에서 값을 가져온 다음 파싱합니다.
    const dataArrayRaw = element.getAttribute('data-array');
    const dataIndex = parseInt(element.getAttribute('data-index'), 10);
    const prependValue = element.getAttribute('data-prepend') || ''; // prepend 값을 가져오거나 빈 문자열 사용
    const dataArray = JSON.parse(dataArrayRaw);
  
    // 원하는 값을 추출하고 "~"를 추가한 후 표시합니다.
    const displayValue = prependValue + dataArray[dataIndex];
    const displayValue1 = dataArray[dataIndex] + prependValue ;
    element.textContent = displayValue;
    element.textContent = displayValue1;
  }
  
  document.addEventListener('DOMContentLoaded', function () {
    // 선택한 요소 처리
    const customElements = document.querySelectorAll('.board__group, .board__deadline, .detail__table--desc');
    customElements.forEach((element) => {
      populateElement(element);
    });
  });

  function formatDate(dateString) {
    const date = new Date(dateString);
    const formatter = new Intl.DateTimeFormat('ko-KR', {
      year: 'numeric',
      month: '2-digit',
      day: '2-digit',
      hour: '2-digit',
      minute: '2-digit',
      hour12: false
    });

    return formatter.format(date);
  }
  document.addEventListener('DOMContentLoaded', function () {
    const postDateElements = document.querySelectorAll('.post-date');
    postDateElements.forEach((element) => {
        const rawDate = element.getAttribute('data-date');
        const formattedDate = formatDate(rawDate);
        element.textContent = formattedDate;
    });
});


</script>
{% endblock %}