{% extends 'layout.html'%}
{% block content %}
{% include 'components/header.html' %}

<main class="group">
    <h1 class='group__title'>{{group_info[0].party_title}}</h1>
    
    <div class="group-plus__box">
        <button class="group-plus-btn">â˜ğŸ»</button>
 
        <ul class="plus__group hidden">
            <p>íŒ€ì›ë“¤ë“¤</p>
            <div class="plus__group__user">
            {%for member in group_info%}
            <li>
                {{member.user_name}}                
            </li>
            {%endfor%}
            </div>
            <!--ê·¸ë£¹ì´ˆëŒ€-->
            <li>ì´ˆëŒ€í•˜ê¸°</li>
            <input type="text" class="group_inv_name" placeholder="ì•„ì´ë””ë¥¼ ì…ë ¥í•˜ì„¸ìš”"><button  class="group_inv_btn" data-id="{{group_info[0].party_idx}}">âœ”</button>
            <!--ê·¸ë£¹ë‚˜ê°€ê¸°-->
            <li class="plus__group__exit">ê·¸ë£¹ ë‚˜ê°€ê¸°</li>

        </ul>

    </div>
    <div class="group__nav">
        <div class="group__board blue">ì»¤ë„¥ë³´ë“œ</div>
        <div class="group__notice">íŒ€ ì†Œí†µ</div>
   
    </div>
    {% include 'components/notice.html' %}
    {% include 'components/canvan.html' %}
    
</main>

{% include 'components/footer.html' %}
<script src="/js/screen/group.js"></script> <!-- path ìˆ˜ì • -->

<script>

//ê·¸ë£¹ì› ì¶”ê°€ë¡œ ì´ˆëŒ€í•˜ê¸°   
    
    $('.group_inv_btn').click((e)=>{
        let group_idx = $('.group_inv_btn').data('id') //group_idx ê°€ì ¸ì˜¤ê¸°    
        let user_id = $('.group_inv_name').val() //ì¶”ê°€ ì´ˆëŒ€í•  ì¸ì› ê°€ì ¸ì˜¤ê¸°
        let url = '/group/group_inv'
        fetch(url, {
                method: "post",
                headers: {
                    "Content-Type": "application/json"
                }, 
                body: JSON.stringify({
                    group_idx: group_idx,
                    user_id:user_id               
                })
    
            })
            .then(res => res.json())
            .then(res =>{   
                    // ê·¸ë£¹ì— ì´ˆëŒ€í•˜ë©´ ìœ ì €ëª©ë¡ì— ì¶”ê°€ë˜ëŠ” ë¡œì§
                if(res==1){alert('ì—†ëŠ” ì•„ì´ë””ì…ë‹ˆë‹¤.')}
                else{
                    $('.plus__group__user').append(` 
                    <li>
                        ${res[0].user_name}                
                    </li>`)



                }
            
            })
            
        
    
    })


//ê·¸ë£¹ ë‚˜ê°€ê¸°
$('.plus__group__exit').click((e)=>{
    let group_idx = $('.group_inv_btn').data('id') //group_idx ê°€ì ¸ì˜¤ê¸° 
    console.log("ì±„íŒ…ë°© ë‚˜ê°€ê¸°",group_idx)
    let url = '/group/exit'
    fetch(url, {
            method: "post",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify({
                party_idx: group_idx             
            })

        }).then(window.location.href = "http://localhost:3000/user/myteam")
        
    

})



</script>





{% endblock %}